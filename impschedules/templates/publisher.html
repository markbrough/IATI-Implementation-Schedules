{% set active_page='publishers'%}{% extends "base.html" %}
{% block content %}
    <script src="/static/jquery.tablesorter.min.js"></script>
    <script >
    $(function() {
    $("table#tablebasic").tablesorter({ sortList: [[0,0]] });
    $("table#tabledetailed").tablesorter({ sortList: [[0,1],[1,0]] });
    });

    </script>
    <a class="btn btn-success pull-right" href="{{url_for('publisher_edit', id=publisher.id)}}">Edit</a>
    <h1>{{publisher.publisher_actual}}</h1>
    <p class="lead">Score: {{score|int}}%</p>
    <p><b>Calculation:</b><br />{{score_calculations}}</p>
    <ul class="nav nav-tabs" id="pageTab">
        <li><a href="#basic" data-toggle="tab" class="firsttab">Basic information</a></li>
        <li><a href="#detailed" data-toggle="tab" class="secondtab">Detailed information</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane" id="basic">
            <h3>Basic information</h3>
            <table class="table" id="tablebasic">
            <thead>
                <th>Item</th>
                <th>Value</th>
            </thead>
            <tbody>
            <tr>
                <td>Publisher name</td>
                <td>{{publisher.publisher_actual}}</td>
            </tr>
            <tr>
                <td>Publisher code</td>
                <td>{{publisher.publisher_code_actual}}</td>
            </tr>
            <tr>
                <td>Schedule version</td>
                <td>{{publisher.schedule_version_actual}}</td>
            </tr>
            <tr>
                <td>Schedule date</td>
                <td>{{publisher.schedule_date_actual}}</td>
            </tr>
            {% for segment in segments %}
            <tr>
                <td>{{properties.properties[segment.segment]["name"]}}</td>
                <td>{% if properties.properties[segment.segment]["type"] == "text" %}{% if segment.segment_value_actual is not none %}{{segment.segment_value_actual}}{%endif%}{%else%}
                {{properties.codes[properties.properties[segment.segment]["code"]][segment.segment_value_actual]}}
                {% endif%}</td>
            </tr>
            {% endfor %}
            </tbody>
            </table>
        </div>
        <div class="tab-pane active" id="detailed">
            <h3>Detailed information</h3>
            <table class="table" id="tabledetailed">
            <thead>
                <th>Level</th>
                <th>Element</th>
                <th>Compliance</th>
                <th>Publication date</th>
                <th>Notes</th>
                <th>Exclusions</th>
            </thead>
            <tbody>
            {% for d in data %}
            {% if d["data"][0] %}
                <tr{%if (d["data"][0].data=='uc') %} class="error"{%elif (d["data"][0].data=='fp') %} class="info"{%endif%}>
                        <td>{{d["element"].level|capitalize}}</td>
                        <td><a href="{{url_for('element', id=d["element"].id, type=d["property"].defining_attribute_value)}}">{{d["element"].description}}{% if d["property"].defining_attribute_value %}
                            ({{d["property"].defining_attribute_value}})
                        {%endif%}</a></td>
                        <td>{%
                        if (d["data"][0].status_actual=="fc")
                        %}<i class="icon-ok" title="Fully compliant"></i><br />Compliant{%
                        elif (d["data"][0].status_actual=="uc")
                        %}<i class="icon-remove" title="Uncompliant"></i><br />Uncompliant{%
                        elif (d["data"][0].status_actual=="pc")
                        %}<i class="icon-flag" title="Partially compliant"></i><br />Partial{%
                        elif (d["data"][0].status_actual=="up")
                        %}<i class="icon-remove" title="Unable to publish"></i><br />Unable{%
                        elif (d["data"][0].status_actual=="fp")
                        %}<i class="icon-wrench" title="Future publication"></i><br />Future
                        {% else %}
                        {{ d["data"][0].status }}
                        {%endif%}</td>
                        <td>{{d["data"][0].date_actual}}</td>
                        <td>{{d["data"][0].notes_actual}}</td>
                        <td>{% if d["data"][0].exclusions is not none %}{{d["data"][0].exclusions}}{%endif%}</td>
                </tr>
                {%endif%}
                {% endfor %}
            </tbody>
            </table>
        </div>
    </div>
    <script>
     $(function () {
    $('#pageTab .secondtab').tab('show');
    })
    </script>
{% endblock %}
