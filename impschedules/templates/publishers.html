{% set title='Organisations | Implementation schedule browser'%}{% set active_page='organisations'%}{% extends "base.html" %}
{% block content %}
    <script src="/static/jquery.tablesorter.min.js"></script>
    <script >
    $(function() {
    $("table#organisations").tablesorter({ sortList: [[0,0]] });
    $("table#noschedules").tablesorter({ sortList: [[0,0]] });
    });

    </script>
    {% if auth%}<a class="btn btn-success pull-right" href="{{url_for('import_schedule')}}">Import new schedule</a>{%endif%}
	<h1>Select an organisation</h1>
    <table class="table" id="organisations">
    <thead>
    <th width="60%">Organisation</th><th width="20%">Initial implementation</th>{% if auth %}<th>Total score</th><th>Will publish</th><th>Approach</th><th>Fields</th>{%endif%}<th width="20%">Group</th>
    </thead>
    <tbody>
	{% for org,org_data in orgs.items() %}
    <tr>
	<td><a href="{{url_for('organisation', id=org_data.publisher.publisher_code_actual)}}">{{ org_data.publisher.publisher_actual }}</a></td>
    <td>{{org_data.properties.publishing_timetable_date_initial.value}}</td>
    {% if auth %}
    <td>{{scores[org].score.total}}</td>
    <td>{{scores[org].score.will_publish}}</td>
    <td>{{scores[org].score.approach}}</td>
    <td>{{scores[org].score.elements}}</td>
    {% endif %}
    <td><span class="{{scores[org].score.group_code}} label lead label-publishers" >{{scores[org].score.group}}</span></td>
    </tr>
	{% endfor %}
    </tbody>
    <table class="table" id="noschedules">
    <tbody>
    <tr class="info"><td colspan="3"><b>No implementation schedules</b></td></tr>
    {% for publisher, publishervalues in notpublishing.items() %}
    <tr>
    <td width="60%">{% if auth %}<a href="{{url_for('organisation_edit', id=publishervalues[1])}}">{{publishervalues[0]}}</a>{%else%}{{publishervalues[0]}}{%endif%}</td>
    <td width="20%"></td>
    <td width="20%"><span class="label-inverse label lead label-publishers">No schedule</span></td>
    </tr>
    {%endfor%}
    </tbody>
    </table>

{% endblock %}
